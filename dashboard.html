<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="icon" href="./style/images/logo-32.png" type="image/x-icon">
    <title>Plug Streaming</title>

    <!-- Bootstrap CSS CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="./style/library.css">
    <link rel="stylesheet" href="./style/main.css">
    <link rel="stylesheet" href="./style/cards.css">

    <!-- Google Icons -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />


    <link href="vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
    <link
        href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
        rel="stylesheet">
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script src="https://d3js.org/d3.v6.min.js"></script>
        <style>
            #VishnuChart {
                max-width: 100%;
                margin: 0 auto;
                color: white;
            }
    
            .value-label {
                
                font-size: 12px;
                fill: white;
                text-anchor: middle;
            }
            #vishnupiechart-container {
                max-width: 100%;
                margin: 0 auto;
            }

        </style>
</head>

<body>
    <div class="wrapper" style="width: 100%;"><!-- Main wrapper -->
        <div class="col justify-content-center"> <!-- Right Content  -->
            <div id="content">
                <!-- MAIN HEADER AND NAVIGATION -->
                <header>
                    <div class="container">
                        <nav id="navbar" class="navbar navbar-expand-sm navbar-collapse">
                            <div class="container-fluid">
                                <!-- Navigation Top -->
                                <div id="head-nav">
                                    <ul class="nav navbar-nav d-flex ml-auto text-center">

                                        <li class="nav-item active">
                                            <a class="nav-link" href="index.html">
                                                <span class="large-screen-text">
                                                    <i class="material-icons">library_books</i>
                                                    &thinsp;UI Library</span>
                                                <i class="small-screen-icon material-icons">library_books</i>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link" href="dashboard.html">
                                                <span class="large-screen-text">
                                                    <i class="material-icons">dashboard</i>
                                                    &thinsp;Dashboard</span>
                                                <i class="small-screen-icon material-icons">dashboard</i>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <img class="header-logo" id="logo-large" src="./style/images/logo-wide.png" alt="">
                                    <img class="header-logo" id="logo-small" src="./style/images/logo-square.png"
                                        alt="">
                                </div>
                            </div>
                        </nav>
                    </div>
                </header>


                <!-- Page Contents -->
                <div class="content-container container">
                    <h6>Dashboard</h6>
                    <h2>Dashboard</h2>


                    <div class="container">

                        <!--SV Content Row -->
                        <div class="row flex-column flex-md-row justify-content-center justify-content-md-between">

                            <!-- SV1 Card Example -->
                            <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card-dark-md fixed-height-small card-shadow-dark">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                    Channel With Most Subscribers</div>
                                                <div class="h5 mb-0 font-weight-bold text-gray-800">$40,000</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- SV2 Card Example -->
                            <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card-dark-md fixed-height-small card-shadow-dark">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                                    Video With Highest Views
                                                </div>
                                                <div class="h5 mb-0 font-weight-bold text-gray-800">$40,000</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="fas fa-calendar fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- SV3 Card Example -->
                            <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card-dark-md fixed-height-small card-shadow-dark">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                                    Video With Highest Earnings
                                                </div>
                                                <div class="row no-gutters align-items-center">
                                                    <div class="col-auto">
                                                        <div class="h5 mb-0 mr-3 font-weight-bold text-gray-800">50%
                                                        </div>
                                                    </div>
                                                    <div class="col">
                                                        <div class="progress progress-sm mr-2">
                                                            <div class="progress-bar bg-info" role="progressbar"
                                                                style="width: 50%" aria-valuenow="50" aria-valuemin="0"
                                                                aria-valuemax="100"></div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- SV4 Card Example -->
                            <div class="col-xl-3 col-md-6 mb-4">
                                <div class="card-dark-md fixed-height-small card-shadow-dark">
                                    <div class="card-body">
                                        <div class="row no-gutters align-items-center">
                                            <div class="col mr-2">
                                                <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                                    Video With Highest Engagement
                                                </div>
                                                <div class="h5 mb-0 font-weight-bold text-gray-800">18</div>
                                            </div>
                                            <div class="col-auto">
                                                <i class="fas fa-comments fa-2x text-gray-300"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div> <!-- End SV row -->

                        <!-- First Row -->
                        <div class="row flex-column flex-md-row justify-content-center justify-content-md-between">
                            <div class="col col-md-6 card-dark-md card-shadow-dark fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Chart 1</h6>
                                </div>

                                <div class="chart-one">
                                    
                                    <img src="./style/images/charts/spider_chart_1.png"  class="img-fluid"
                                        alt="Pie chart 1">
                                </div>

                                <div id="chart1">
                                    
                                </div>
                                <!-- Your first chart content here -->
                            </div>

                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Chart 2</h6>
                                </div>

                                <div class="chart-two">
                                    
                                    <img src="./style/images/charts/line_chart_2.png" class="img-fluid"
                                        alt="Pie chart 2">
                                </div>
                                <div id="chart2">
                                    
                                </div>
                                <!-- Your second chart content here -->
                            </div>
                        </div> <!-- End Row 1 -->

                        <!-- Second Row -->
                        <div class="row flex-column flex-md-row justify-content-center justify-content-md-between">
                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary" >Chart 3</h6>
                                </div>

                                <div class="chart-three">
                                    
                                    <img src="./style/images/charts/bar_chart_1.png" style="max-height: 300px;"class="img-fluid"
                                    alt="Pie chart 3">
                                    
                                </div>

                                <div id="chart3">
                                    
                                </div>
                                <!-- Your third chart content here -->
                            </div>

                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Chart 4</h6>
                                </div>

                                <div class="chart-four">
                                    
                                    <img src="./style/images/charts/line_chart_1.png" class="img-fluid"
                                        alt="Pie chart 4">
                                </div>

                                <div id="chart4">
                                    
                                </div>
                                <!-- Your fourth chart content here -->
                            </div>
                        </div>

                        <!-- Third Row -->
                        <div class="row flex-column flex-md-row justify-content-center justify-content-md-between">
                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Chart 5</h6>
                                </div>

                                <div class="chart-five">
                                    
                                    <img src="./style/images/charts/bar_chart_2.png" class="img-fluid"
                                        alt="Pie chart 5">
                                </div>

                                <div id="chart5">
                                    
                                </div>
                                <!-- Your fifth chart content here -->
                            </div>

                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary" id="chartTitle">YouTube Channels by Category (IN)</h6>
                                </div>

                                <div class="chart-six">
                                    
                                    <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                        Select Country:
                                        <select id="countrySelect">
                                            <option value="IN" selected>IN</option>
                                            <!-- Other country options will be added dynamically -->
                                        </select>
                                    </div>
                                    

                                    <div id="VishnuChart"></div>

                                    <script>
                                        var margin = {top: 20, right: 20, bottom: 100, left: 80},
                                        width = 960 - margin.left - margin.right,
                                        height = 400 - margin.top - margin.bottom,
                                        barWidth = 40;  // Set a fixed width for the bars

                                        var x = d3.scaleBand().rangeRound([0, width]).padding(0.1),
                                            y = d3.scaleLinear().rangeRound([height, 0]);

                                        d3.csv("./data/top_100_youtubers.csv").then(function(data) {
                                            var countries = [...new Set(data.map(row => row.Country))];
                                            var select = d3.select("#countrySelect");
                                            select.selectAll('option')
                                                    .data(countries)
                                                    .enter()
                                                    .append('option')
                                                    .text(function (d) { return d; });

                                            select.on("change", function(d) {
                                                var value = d3.select(this).property("value");
                                                updateChart(value);
                                            });

                                            updateChart("IN");

                                            function updateChart(country) {
                                            // Remove the old chart
                                                d3.select("#VishnuChart").selectAll("*").remove();

                                                var svg = d3.select("#VishnuChart").append("svg")
                                                            .attr("preserveAspectRatio", "xMinYMin meet")
                                                            .attr("viewBox", "0 0 " + (width + margin.left + margin.right) + " " + (height + margin.top + margin.bottom))
                                                            .classed("svg-content", true)
                                                            .append("g")
                                                            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

                                                d3.select("#chartTitle").text(`Count of YouTube Channels by Country (${country})`);
                                                var filteredData = data.filter(row => row.Country === country);
                                                var categories = d3.nest()
                                                                    .key(function(d) { return d.Category; })
                                                                    .entries(filteredData);

                                                x.domain(categories.map(function(d) { return d.key; }));
                                                y.domain([0, d3.max(categories, function(d) { return d.values.length+1; })]);

                                                svg.append("g")
                                                    .attr("class", "axis axis--x")
                                                    .attr("transform", "translate(0," + height + ")")
                                                    .call(d3.axisBottom(x))
                                                    .selectAll("text")
                                                    .style("text-anchor", "end")
                                                    .attr("dx", "-.8em")
                                                    .attr("dy", ".15em")
                                                    .attr("transform", "rotate(-45)");

                                                svg.append("text")             
                                                    .attr("transform", "translate(" + (width/2) + " ," + (height + margin.top + 70) + ")")
                                                    .style("fill",'white')
                                                    .style("text-anchor", "middle")
                                                    .text("Categories"),
                    

                                                svg.append("g")
                                                    .attr("class", "axis axis--y")
                                                    .call(d3.axisLeft(y).ticks(11))
                                                    .append("text")
                                                    .attr("transform", "rotate(-90)")
                                                    .attr("y", 200)
                                                    .attr("x", 10)
                                                    .attr("dy", "1em")
                                                    .style("text-anchor", "middle")
                                                    .text("Number of YouTube Channels");

                                                svg.selectAll(".bar")
                                                    .data(categories)
                                                    .enter().append("rect")
                                                    .attr("class", "bar")
                                                    .attr("x", function(d) { return x(d.key) + (x.bandwidth() - barWidth) / 2; })  // Adjust the x position
                                                    .attr("y", function(d) { return y(d.values.length); })
                                                    .attr("width", barWidth)  // Use the fixed bar width
                                                    .attr("height", function(d) { return height - y(d.values.length); })
                                                    .attr("fill", '#ff7119')  // Set the color of the bars 
                                                    .on("mouseover", function(d) {
                                                        var xPos = x(d.key) + x.bandwidth() / 2;
                                                        var yPos = y(d.values.length) + 15; // Adjust position inside the bar
                                                        svg.append("text")
                                                            .attr("class", "value-label")
                                                            .attr("x", xPos)
                                                            .attr("y", yPos)
                                                            .text(d.values.length)
                                                            .style("text-anchor", "middle");
                                                    })
                                                    .on("mouseout", function() {
                                                        svg.selectAll(".value-label").remove();
                                                    });
                                            }
                                        });
                                </script>
                                </div>
                                <!-- Your sixth chart content here -->
                            </div>
                        </div>

                        <!-- Fourth Row -->
                        <div class="row flex-column flex-md-row justify-content-center justify-content-md-between">
                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Category with most followers</h6>
                                </div>

                                <div class="chart-seven" id="pie-chart-contain">
                                    
                                    <div id="vishnupiechart-container">
                                        <div id="vishnupiechart"></div>
                                        <div id="vishnupiechartlegend"></div>
                                    </div>
                                    
                                    <script>
                                        // Load the CSV file
                                        d3.csv("./data/top_100_youtubers.csv").then(function(data) {
                                    
                                            // Group the data by the 'Category' column
                                            var grouped = d3.group(data, d => d.Category);
                                    
                                            // Convert the Map to an array of [key, value] pairs
                                            var groupedArray = Array.from(grouped);
                                    
                                            // For each group, sum the 'followers'
                                            var sums = groupedArray.map(([key, value]) => {
                                                return {
                                                    category: key,
                                                    totalFollowers: d3.sum(value, d => +d.followers)
                                                };
                                            });
                                    
                                            // Set dimensions based on the parent container
                                            var containerWidth = document.getElementById('pie-chart-contain').offsetWidth;
                                            var containerHeight = document.getElementById('pie-chart-contain').offsetHeight;
                                            var width = containerWidth;
                                            var height = containerWidth-320;
                                            var radius = Math.min(width, height) / 2;
                                    
                                            var svg = d3.select('#vishnupiechart')
                                                .append('svg')
                                                .attr('preserveAspectRatio', 'xMinYMin meet')
                                                .attr('viewBox', '0 0 ' + width + ' ' + height)
                                                .classed('svg-content', true)
                                                .append('g')
                                                .attr('transform', 'translate(' + width / 2 + ',' + height / 2 + ')');
                                    
                                            // Define your own color scale
                                            var color = d3.scaleOrdinal()
                                                .domain(sums.map(d => d.category).sort())
                                                .range(["#734a10", "#fe3e11", "#fff7ed", "#a47604", "#1e6367", "#b263e9", "#ff7119", "#46b9bb", "#efd103"]);  // Add more colors if needed
                                    
                                            var pie = d3.pie().value(function(d) { return d.totalFollowers; });
                                            var path = d3.arc().outerRadius(radius - 10).innerRadius(0);
                                            var label = d3.arc().outerRadius(radius - 40).innerRadius(radius - 40);
                                    
                                            var arc = svg.selectAll('.arc')
                                                .data(pie(sums))
                                                .enter().append('g')
                                                .attr('class', 'arc');
                                    
                                            arc.append('path')
                                                .attr('d', path)
                                                .attr('fill', function(d) { return color(d.data.category); });
                                    
                                            // Add a legend
                                            var legendRectSize = 10;
                                            var legendSpacing = 10;
                                            var legendPerRow = 3;
                                            var legendHeight = Math.ceil(color.domain().length / legendPerRow) * (legendRectSize + legendSpacing);
                                    
                                            var legendSvg = d3.select('#vishnupiechartlegend')
                                                .append('svg')
                                                .attr('preserveAspectRatio', 'xMinYMin meet')
                                                .attr('viewBox', '0 0 ' + width + ' ' + legendHeight)
                                                .classed('svg-content', true)
                                                .selectAll('.vishnupiechartlegend')
                                                .data(color.domain())
                                                .enter()
                                                .append('g')
                                                .attr('class', 'vishnupiechartlegend')
                                                .attr('transform', function(d, i) {
                                                    // Calculate total width of legend items
                                                    var totalWidth = legendPerRow * (legendRectSize + legendSpacing) * 6;

                                                    // Center the legend items
                                                    var horz = (width - totalWidth) / 2 + (i % legendPerRow) * (legendRectSize + legendSpacing) * 6;
                                                    var vert = Math.floor(i / legendPerRow) * (legendRectSize + legendSpacing);

                                                    return 'translate(' + horz + ',' + vert + ')';
                                                });

                                    
                                            legendSvg.append('rect')
                                                .attr('width', legendRectSize)
                                                .attr('height', legendRectSize)
                                                .style('fill', color)
                                                .style('stroke', color);
                                    
                                            legendSvg.append('text')
                                                .attr('x', legendRectSize + legendSpacing)
                                                .attr('y', legendRectSize)
                                                .style('font-size', '10px')
                                                .style('fill','white')
                                                .text(function(d) { return d; });
                                        }).catch(function(error){
                                           console.log(error);
                                        });
                                    </script>
                                    
                                    
                                </div>
                                <!-- Your seventh chart content here -->
                            </div>

                            <div class="col col-md-6 card-dark-md card-shadow-light fixed-height">
                                <div
                                    class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Chart 8</h6>
                                </div>

                                <div class="chart-eight">
                                    
                                    <img src="./style/images/charts/pie_chart_2.png" class="img-fluid"
                                        alt="Pie chart 8">
                                </div>

                                <div id="chart8">
                                    
                                </div>
                                <!-- Your eighth chart content here -->
                            </div>
                        </div>




                    </div> <!-- Content container for charts -->

                </div> <!-- end Page Contents div -->



            </div> <!-- right side container -->
        </div> <!-- wrapper -->


        <!-- jQuery CDN - Slim version (=without AJAX) -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
        <!-- Popper.JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
            integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
            crossorigin="anonymous"></script>
        <!-- Bootstrap JS -->
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"
            integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
            crossorigin="anonymous"></script>

        <!-- Our Main JS -->
        <script src="./scripts/main.js"></script>

        <!-- Our CHARTS JS -->
        <script src="./scripts/chart1.js"></script>
        <script src="./scripts/chart2.js"></script>
        <script src="./scripts/chart3.js"></script>
        <script src="./scripts/chart4.js"></script>
        <script src="./scripts/chart5.js"></script>
        <script src="./scripts/chart6.js"></script>
        <script src="./scripts/chart7.js"></script>
        <script src="./scripts/chart8.js"></script>

</body>

</html>